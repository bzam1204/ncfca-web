<persona>
You are a developer AI, and you are receiving a task from a solutions architect. Your mission is to execute the plan with precision, adhering strictly to the provided context and instructions. You must follow the project's established patterns and conventions.

**Key Directives:**
- **Adhere to the Plan:** Execute the steps exactly as described. Do not add, remove, or reorder steps.
- **Use Provided Context:** Rely exclusively on the file paths, component names, hooks, and code snippets provided in the `<context>` section. Do not infer or assume the existence of other files or functions.
- **Follow Existing Patterns:** When creating new files or modifying existing ones, replicate the style, structure, and logic of the examples given in the context.
- **Be Precise:** Your changes should be surgical. Do not refactor or modify code outside the scope of the current step.
- **Ask for Clarification:** If any part of the plan is ambiguous or if you encounter a conflict with the existing code, stop and ask for clarification from the solutions architect. Do not try to resolve it yourself.
</persona>

<task>
Implement "Max Members" Functionality for Clubs
</task>

<taskspec>
This task involves adding the ability for administrators and club directors to set a maximum number of members for a club. This limit will then be reflected in the user interface, preventing new enrollment requests when a club is full.

**Acceptance Criteria:**
1.  **Club Editing:** Both Admins and Club Directors must be able to set and update the `maxMembers` for a club. This field should be a number and can be left empty to signify no limit.
2.  **Club Creation:** The form for requesting a new club must include the `maxMembers` field.
3.  **Enrollment UI:**
    -   The public list of clubs must display the current member count versus the maximum (`corum`/`maxMembers`).
    -   The "Request Enrollment" button for a club must be disabled if the club has reached its maximum number of members. The button label should change to "Clube Cheio" (Club Full).
</taskspec>

<context>
**1. Relevant Files and Paths**

*   **DTOs:**
    *   `src/contracts/api/club-management.dto.ts`: Contains `UpdateClubDto` and `CreateClubRequestDto`.
*   **Entities:**
    *   `src/domain/entities/club.entity.ts`: Defines the `Club` interface, which already includes `maxMembers: number | null`.
*   **Frontend - Club Director Flow:**
    *   `src/app/dashboard/club-management/page.tsx`: Main page for club directors.
    *   `src/app/dashboard/club-management/_components/club-management-client.tsx`: Client component for managing a club.
    *   `src/app/dashboard/club-management/_components/edit-club-form.tsx`: The form for directors to edit their club's details.
    *   `src/app/dashboard/club-management/_components/create-club-form.tsx`: The form for users to request the creation of a new club.
*   **Frontend - Admin Flow:**
    *   `src/app/(admin)/admin/dashboard/clubs/[clubId]/page.tsx`: Details page for a specific club in the admin view.
    *   `src/app/(admin)/admin/dashboard/clubs/[clubId]/_components/admin-club-management-client.tsx`: Client component for admin club management.
    *   `src/app/(admin)/admin/dashboard/clubs/[clubId]/_components/admin-edit-club-form.tsx`: The form for admins to edit a club's details.
*   **Frontend - Public Club List:**
    *   `src/app/dashboard/clubs/page.tsx`: Page where users can explore and search for clubs.
    *   `src/app/dashboard/clubs/_components/explore-clubs.tsx`: Component that renders the list of clubs available for enrollment.
*   **Hooks (for reference):**
    *   `src/hooks/use-my-club.ts`: Fetches the current director's club data.
    *   `src/hooks/use-search-clubs.ts`: Fetches the list of all clubs.

**2. Code Snippets and Patterns**

*   **Zod Schema with Nullable Number (Pattern):** When adding `maxMembers` to forms, use this pattern in the Zod schema to allow for an empty string, which should be converted to `null`.
    ```typescript
    maxMembers: z.preprocess(
      (val) => (val === "" ? null : Number(val)),
      z.number().min(1, "O número mínimo de membros é 1.").nullable()
    )
    ```

*   **Input Field in Forms (Pattern):** Use the existing `Input` and `Label` components from the project's UI library.
    ```tsx
    <div className="grid grid-cols-4 items-center gap-4">
      <Label htmlFor="maxMembers" className="text-right">
        Nº Máximo de Membros
      </Label>
      <Input id="maxMembers" type="number" {...register('maxMembers')} className="col-span-3" />
      {errors.maxMembers && <p className="col-span-4 text-red-500 text-sm">{errors.maxMembers.message}</p>}
    </div>
    ```
</context>

<pre-computation>
1.  The `maxMembers` property of type `number | null` already exists on the `Club` entity in `src/domain/entities/club.entity.ts`.
2.  The `CreateClubRequestDto` in `src/contracts/api/club-management.dto.ts` already includes the `maxMembers` field.
3.  The API endpoint for searching clubs (`/clubs`) returns the `corum` and `maxMembers` properties for each club.
</pre-computation>

<step-by-step>
**Part 1: Update Data Contracts and Create Hooks**

1.  **Modify `UpdateClubDto`:**
    *   Open `src/contracts/api/club-management.dto.ts`.
    *   Add the optional `maxMembers` property to the `UpdateClubDto` interface.
    ```typescript
    export interface UpdateClubDto {
      name?: string;
      city?: string;
      state?: string;
      maxMembers?: number | null; // Add this line
    }
    ```

2.  **Create `update-my-club.action.ts`:**
    *   Create a new file at `src/infrastructure/actions/update-my-club.action.ts`.
    *   This action will be responsible for calling the backend API to update the club details for a director. It should handle authentication by getting the session's `accessToken`.
    *   The function should accept `UpdateClubDto` as its payload.

3.  **Create `use-update-my-club.ts` Hook:**
    *   Create a new file at `src/hooks/use-update-my-club.ts`.
    *   Implement a `useUpdateMyClub` hook using `@tanstack/react-query`'s `useMutation`.
    *   This hook should call the `updateMyClubAction`.
    *   On success, it should invalidate the `QueryKeys.clubs.myClub()` query to refetch the club's data.

4.  **Create `update-club-admin.action.ts`:**
    *   Create a new file at `src/infrastructure/actions/admin/update-club.action.ts`.
    *   This action will be similar to the director's one but for admins. It will take a `clubId` as an argument.

5.  **Create `use-admin-update-club.ts` Hook:**
    *   Create a new file at `src/hooks/use-admin-update-club.ts`.
    *   Implement a `useAdminUpdateClubMutation` hook.
    *   This hook should call the `updateClubAdminAction`.
    *   On success, it should invalidate `QueryKeys.clubs.byId(clubId)` and `QueryKeys.clubs.search({})` to ensure all views are updated.

**Part 2: Update User Interface Components**

6.  **Update Director's Edit Form (`edit-club-form.tsx`):**
    *   Open `src/app/dashboard/club-management/_components/edit-club-form.tsx`.
    *   Add the `maxMembers` field to the `editClubSchema` using the Zod pattern from the context.
    *   Add the `InputField` for `maxMembers` to the form JSX, following the provided pattern.
    *   Instantiate the `useUpdateMyClub` hook and call the `mutate` function in the `onSubmit` handler.

7.  **Update Admin's Edit Form (`admin-edit-club-form.tsx`):**
    *   Open `src/app/(admin)/admin/dashboard/clubs/[clubId]/_components/admin-edit-club-form.tsx`.
    *   Add the `maxMembers` field to the `editClubSchema`.
    *   Add the `InputField` for `maxMembers` to the form JSX.
    *   Uncomment the `useAdminUpdateClubMutation` hook (its creation is part of this task).
    *   Call the `mutate` function in the `onSubmit` handler, passing the `clubId` and form data.

8.  **Verify Club Creation Form (`create-club-form.tsx`):**
    *   Open `src/app/dashboard/club-management/_components/create-club-form.tsx`.
    *   The `CreateClubRequestDto` already supports `maxMembers`. Ensure there is an `InputField` for `maxMembers` in this form. If it's missing, add it, following the same patterns as the edit forms.

9.  **Update `ExploreClubs` UI:**
    *   Open `src/app/dashboard/clubs/_components/explore-clubs.tsx`.
    *   Locate the `clubs.map(...)` block where each club card is rendered.
    *   Inside the `CardHeader` or `CardContent`, add a `Badge` component to display the member count. The text should be dynamic:
        ```tsx
        <Badge variant="secondary">{club.corum} / {club.maxMembers || '∞'} membros</Badge>
        ```
    *   Find the "Solicitar Matrícula" `Button`.
    *   Add the `disabled` prop to the button. The condition is `club.maxMembers !== null && club.corum >= club.maxMembers`.
    *   Use a ternary operator to change the button's text:
        ```tsx
        {club.maxMembers !== null && club.corum >= club.maxMembers ? 'Clube Cheio' : 'Solicitar Matrícula'}
        ```
</step-by-step>
