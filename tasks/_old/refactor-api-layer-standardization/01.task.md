status: pending

# 01 — Refatorar `use-admin-management.use-case.ts` para Hooks e Gateway

## Objetivo

Substituir o `use-admin-management.use-case.ts` pela implementação de novos hooks (`useSearchUsers`, `useAdminUserById`, `useManageUserRole`, `useAdminUserFamily`) que consomem o `AdminGateway`.

## Arquivos e Caminhos

- **Editar (Interface):** `/src/application/gateways/admin.gateway.ts`
- **Editar (Implementação):** `/src/infrastructure/gateways/admin.gateway.http.ts`
- **Criar (Hooks):**
  - `/src/hooks/use-search-users.ts`
  - `/src/hooks/use-admin-user-by-id.ts`
  - `/src/hooks/use-manage-user-role.ts`
  - `/src/hooks/use-admin-user-family.ts`
- **Refatorar (Componentes):** Identificar os componentes que usam `use-admin-management.use-case.ts` e substituí-lo pelos novos hooks.
- **Deletar (Use-Case):** `/src/application/use-cases/use-admin-management.use-case.ts`

## Contratos e Estruturas

**1. `AdminGateway` (Interface)**
Adicionar as seguintes assinaturas de método:

```typescript
import { User } from '@/domain/entities/user';
import { Family } from '@/domain/entities/family';

// ... (manter métodos existentes)
export abstract class AdminGateway {
  // ...
  abstract searchUsers(query: string): Promise<User[]>;
  abstract getUserById(id: string): Promise<User>;
  abstract manageUserRole(userId: string, roles: string[]): Promise<void>;
  abstract viewUserFamily(userId: string): Promise<Family>;
}
```

**2. `AdminGatewayHttp` (Implementação)**
Implementar a lógica para os novos métodos, utilizando `fetch` para chamar os endpoints da API definidos no `openapi.json`.

## Passo a Passo

1.  **Gateway:** Adicione os novos métodos à interface `AdminGateway` e implemente-os em `AdminGatewayHttp`.
2.  **Hooks:** Crie os quatro hooks especificados. Use `useQuery` para as operações de busca (`searchUsers`, `getUserById`, `viewUserFamily`) e `useMutation` para a operação de escrita (`manageUserRole`).
3.  **Injeção de Dependência:** Assegure que o container de DI em `/src/infrastructure/containers` está corretamente configurado para `AdminGateway`.
4.  **Refatoração:** Investigue o código-fonte para encontrar onde `useAdminManagementUseCase` é chamado. Substitua essas chamadas pelos novos hooks. Por exemplo, uma chamada a `useAdminManagementUseCase().searchUsers(...)` deve ser trocada por `useSearchUsers(...)`.
5.  **Limpeza:** Após garantir que todas as chamadas foram substituídas e a funcionalidade foi verificada, delete o arquivo `/src/application/use-cases/use-admin-management.use-case.ts`.

## Critérios de Aceite

- A busca de usuários na área de administração funciona como antes.
- A visualização de detalhes de um usuário na área de administração funciona como antes.
- A funcionalidade de alterar papéis (roles) de um usuário está operacional.
- A visualização da família de um usuário pelo admin funciona corretamente.
- O arquivo `use-admin-management.use-case.ts` foi removido do projeto.

## Testes Mínimos

- Testar manualmente a página de gerenciamento de usuários na área de admin, verificando a busca, visualização de detalhes e modificação de papéis.
