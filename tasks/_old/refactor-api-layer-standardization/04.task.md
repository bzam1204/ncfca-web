status: pending

# 04 — Unificar Use-Cases de Família (`use-manage-dependants`, `use-dependant-details`, `use-my-family`) em Hooks e Gateway

## Objetivo

Consolidar a lógica de múltiplos use-cases relacionados à família (`use-manage-dependants.use-case.ts`, `use-dependant-details.use-case.ts`, `use-my-family.use-case.ts`) em um único `FamilyGateway` e um conjunto coeso de hooks.

## Arquivos e Caminhos

- **Editar (Interface):** `/src/application/gateways/family.gateway.ts`
- **Editar (Implementação):** `/src/infrastructure/gateways/family.gateway.http.ts`
- **Criar/Editar (Hooks):**
  - `/src/hooks/use-my-family.ts`
  - `/src/hooks/use-list-dependants.ts`
  - `/src/hooks/use-dependant-details.ts`
  - `/src/hooks/use-add-dependant.ts`
  - `/src/hooks/use-update-dependant.ts`
  - `/src/hooks/use-delete-dependant.ts`
- **Refatorar (Componentes):** Atualizar todas as UIs que consomem os use-cases de família para usar os novos hooks.
- **Deletar (Use-Cases):**
  - `/src/application/use-cases/use-manage-dependants.use-case.ts`
  - `/src/application/use-cases/use-dependant-details.use-case.ts`
  - `/src/application/use-cases/use-my-family.use-case.ts`

## Contratos e Estruturas

**1. `FamilyGateway` (Interface)**
Adicionar ou garantir que a interface contenha todos os métodos necessários para gerenciar a família e seus dependentes.

```typescript
import { Family } from '@/domain/entities/family';
import { Dependant } from '@/domain/entities/dependant';

export abstract class FamilyGateway {
  abstract viewMyFamily(): Promise<Family>;
  abstract listDependants(): Promise<Dependant[]>;
  abstract viewDependant(id: string): Promise<Dependant>;
  abstract addDependant(dependantData: Omit<Dependant, 'id'>): Promise<Dependant>;
  abstract updateDependant(id: string, dependantData: Partial<Dependant>): Promise<Dependant>;
  abstract deleteDependant(id: string): Promise<void>;
}
```

**2. `FamilyGatewayHttp` (Implementação)**
Implementar todos os métodos da interface, realizando as chamadas `fetch` para os endpoints da API correspondentes.

## Passo a Passo

1.  **Gateway:** Atualize a interface `FamilyGateway` e a implementação `FamilyGatewayHttp` com todos os métodos listados.
2.  **Hooks:** Crie ou ajuste os hooks para cada operação. Use `useQuery` para leitura (`viewMyFamily`, `listDependants`, `viewDependant`) e `useMutation` para escrita (`addDependant`, `updateDependant`, `deleteDependant`).
3.  **Refatoração:** Rastreie o uso dos três `use-cases` (`useManageDependantsUseCase`, `useDependantDetailsUseCase`, `useMyFamilyUseCase`) e substitua-os pelos hooks apropriados.
4.  **Limpeza:** Após a refatoração e verificação, delete os três arquivos de use-case.

## Critérios de Aceite

- A página "Minha Família" carrega e exibe os dados corretamente.
- A lista de dependentes é exibida corretamente.
- É possível adicionar, visualizar, editar e remover um dependente.
- Todas as funcionalidades que dependiam dos use-cases de família continuam operacionais.
- Os três arquivos de use-case (`use-manage-dependants.use-case.ts`, `use-dependant-details.use-case.ts`, `use-my-family.use-case.ts`) foram removidos.

## Testes Mínimos

- Acessar a página de gerenciamento de família/dependentes.
- Adicionar um novo dependente.
- Editar os dados de um dependente existente.
- Remover um dependente.
- Verificar se a visualização da família e da lista de dependentes reflete as mudanças.
