status: pending

# 01 — Estender Gateways conforme OpenAPI

## Objetivo
Alinhar `AdminGateway`, `ClubGateway` e `FamilyGateway` ao contrato `openapi.json`, adicionando métodos faltantes (especialmente rotas Admin de membros, matrículas e gráficos por clube) com assinaturas e DTOs explícitos.

## Arquivos e caminhos (criar/editar)
- Editar: `src/application/gateways/admin.gateway.ts`
- Editar: `src/application/gateways/club.gateway.ts`
- Editar: `src/application/gateways/family.gateway.ts`
- Criar (se faltarem DTOs): `src/contracts/api/admin-charts.dto.ts`

## Contratos e estruturas (DTOs/interfaces)
- `AdminGateway` — adicionar:
  - `getClubMembers(clubId: string): Promise<ClubMemberDto[]>` — response `members: ClubMemberDto[]` (vide `src/contracts/api/club-member.dto.ts`).
  - `getClubCharts(clubId: string): Promise<AdminClubChartsDto>` — ver `GET /admin/clubs/{clubId}/charts` no `openapi.json` e criar `AdminClubChartsDto` com:
    - `memberCountByType: { type: string; count: number }[]`
    - `memberCountBySex: { sex: string; count: number }[]`
    - `enrollmentsOverTime: { month: string; count: number }[]`
    - `totalActiveMembers: number`
    - `totalPendingEnrollments: number`
  - `approveEnrollment(clubId: string, enrollmentId: string): Promise<void>` — `POST /admin/clubs/{clubId}/enrollments/{enrollmentId}/approve`
  - `rejectEnrollment(clubId: string, enrollmentId: string, payload?: { rejectionReason?: string }): Promise<void>` — `POST /reject`
- Avaliar `ClubGateway` e `FamilyGateway`: manter como estão se já cobrem `openapi.json`; documentar lacunas, se houver.

## Regras de negócio e validações
- Todos os métodos Admin exigem contexto autenticado (token no server), sem leitura em cliente.
- Erros HTTP devem propagar mensagens do body.

## Passo a passo
1) Mapear no `openapi.json` as rotas Admin usadas nas telas: members, charts, approve/reject enrollment, users family.
2) Atualizar `admin.gateway.ts` com os métodos e docstring apontando a rota OpenAPI.
3) Se necessário, criar `AdminClubChartsDto` em `src/contracts/api/admin-charts.dto.ts` seguindo o schema do OpenAPI.
4) Validar `club.gateway.ts` e `family.gateway.ts` contra `openapi.json` e listar gaps no PR.

## Critérios de aceite
- Métodos adicionados em `AdminGateway` com assinaturas acima.
- DTO `AdminClubChartsDto` criado conforme schema do OpenAPI (se não existir).
- PR descreve mapeamento método→rota do OpenAPI.

## Testes mínimos (âncoras)
- Tipagem compila e consumidores podem importar os novos métodos.
- Snapshot do `openapi.json` referenciado nas docstrings dos métodos.

## Notas de versão/refs (Context7)
- Next.js 15 / Server Actions.
- TanStack Query v5 para `QueryKeys`.
- Fonte de contrato: `openapi.json`.

